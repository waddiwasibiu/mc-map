<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baka 村结构坐标库 - 本地管理</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        accent: '#F59E0B',
                        dark: '#1E293B',
                        server1: '#3B82F6',
                        server2: '#10B981'
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-hover {
                transition: all 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            }
            .structure-image {
                background-color: #f0f0f0;
                background-size: cover;
                background-position: center;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-inter">
    <!-- 导航栏 -->
    <header class="bg-white shadow-md fixed top-0 left-0 right-0 z-40 transition-all duration-300 py-4">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <i class="fa fa-map-o text-primary text-2xl"></i>
                    <h1 class="text-xl font-bold text-dark">Baka 村 <span class="text-primary">结构坐标</span></h1>
                </div>
                
                <nav class="hidden md:flex space-x-6">
                    <a href="#home" class="text-gray-700 hover:text-primary transition-colors">首页</a>
                    <a href="#structures" class="text-gray-700 hover:text-primary transition-colors">结构列表</a>
                    <a href="#add-structure" class="text-gray-700 hover:text-primary transition-colors">添加结构</a>
                    <a href="#about" class="text-gray-700 hover:text-primary transition-colors">关于我们</a>
                </nav>
                
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="搜索结构或坐标..." class="pl-10 pr-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary">
                        <i class="fa fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>
                    
                    <button class="md:hidden text-gray-700 focus:outline-none" id="mobileMenuBtn">
                        <i class="fa fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
            
            <!-- 移动端菜单 -->
            <div id="mobileMenu" class="hidden md:hidden mt-4 pb-4">
                <a href="#home" class="block py-2 text-gray-700 hover:text-primary transition-colors">首页</a>
                <a href="#structures" class="block py-2 text-gray-700 hover:text-primary transition-colors">结构列表</a>
                <a href="#add-structure" class="block py-2 text-gray-700 hover:text-primary transition-colors">添加结构</a>
                <a href="#about" class="block py-2 text-gray-700 hover:text-primary transition-colors">关于我们</a>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="container mx-auto px-4 pt-24 pb-16">
        <!-- 欢迎部分 -->
        <section id="home" class="mb-12">
            <div class="bg-gradient-to-r from-primary/10 to-secondary/10 rounded-2xl p-8 shadow-lg">
                <div class="flex flex-col md:flex-row items-center">
                    <div class="md:w-1/2 mb-6 md:mb-0">
                        <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-dark mb-4">欢迎来到 Baka 村结构坐标库</h2>
                        <p class="text-gray-600 mb-6 text-lg">探索并分享《我的世界》中各种独特结构的坐标，让冒险更加便捷！</p>
                        <div class="flex flex-wrap gap-4">
                            <a href="#structures" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors shadow-lg shadow-primary/20 flex items-center">
                                <i class="fa fa-map-marker mr-2"></i> 浏览结构
                            </a>
                            <a href="#add-structure" class="px-6 py-3 bg-white text-primary border border-primary rounded-lg hover:bg-primary/5 transition-colors flex items-center">
                                <i class="fa fa-plus mr-2"></i> 添加新结构
                            </a>
                        </div>
                    </div>
                    <div class="md:w-1/2 flex justify-center">
                        <div class="structure-image w-full h-64 rounded-xl" style="background-image: url('1.png')"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 添加结构部分 -->
        <section id="add-structure" class="mb-12 bg-white rounded-xl shadow-md p-6">
            <h2 class="text-2xl font-bold text-dark mb-6">添加新结构</h2>
            <form id="addStructureForm">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">结构名称</label>
                        <input type="text" id="structureName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary" placeholder="例如：海底神殿" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">结构类型</label>
                        <select id="structureType" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary" required>
                            <option value="">选择类型</option>
                            <option value="遗迹">遗迹</option>
                            <option value="自然奇观">自然奇观</option>
                            <option value="村庄">村庄</option>
                            <option value="要塞">要塞</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">结构描述</label>
                        <textarea id="structureDescription" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary" placeholder="描述这个结构的特征和重要性..." required></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">图片编号</label>
                        <div class="flex items-center">
                            <span class="px-4 py-3 bg-gray-100 rounded-l-lg border border-r-0 border-gray-300">img</span>
                            <input type="number" id="structureImage" min="2" max="20" class="w-full px-4 py-3 border border-gray-300 rounded-r-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary" placeholder="2-20" required>
                            <span class="ml-2 text-gray-500">.png</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">输入2-20之间的数字，对应本地图片文件 (如输入"2"对应"2.png")</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">结构图标</label>
                        <select id="structureIcon" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary" required>
                            <option value="">选择图标</option>
                            <option value="fa-fort-awesome">堡垒</option>
                            <option value="fa-tree">丛林</option>
                            <option value="fa-sun-o">沙漠</option>
                            <option value="fa-tornado">旋风</option>
                            <option value="fa-cloud">云朵</option>
                            <option value="fa-home">村庄</option>
                            <option value="fa-diamond">宝藏</option>
                            <option value="fa-ship">沉船</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end gap-4">
                    <button type="reset" class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                        重置表单
                    </button>
                    <button type="submit" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors shadow-lg shadow-primary/20 flex items-center">
                        <i class="fa fa-plus mr-2"></i> 添加结构
                    </button>
                </div>
            </form>
        </section>

        <!-- 服务器选择和筛选 -->
        <section class="mb-8">
            <div class="bg-white rounded-xl shadow-md p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div class="flex items-center gap-4">
                        <label for="serverSelector" class="font-medium text-gray-700">服务器:</label>
                        <select id="serverSelector" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary">
                            <option value="server1">一区</option>
                            <option value="server2">二区</option>
                        </select>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <label for="sortSelect" class="font-medium text-gray-700">排序方式:</label>
                        <select id="sortSelect" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary">
                            <option value="nameAsc">名称 (升序)</option>
                            <option value="nameDesc">名称 (降序)</option>
                            <option value="type">结构类型</option>
                            <option value="coordinateCount">坐标数量</option>
                        </select>
                    </div>
                </div>
            </div>
        </section>

        <!-- 结构列表 -->
        <section id="structures" class="space-y-6">
            <!-- 一区内容 -->
            <div id="server1Content">
                <!-- 结构卡片将通过JavaScript动态生成 -->
            </div>
            
            <!-- 二区内容 -->
            <div id="server2Content" class="hidden">
                <!-- 结构卡片将通过JavaScript动态生成 -->
            </div>
        </section>
    </main>

    <!-- 关于我们 -->
    <section id="about" class="bg-white py-12">
        <div class="container mx-auto px-4">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-dark mb-4">关于 Baka 村</h2>
                <p class="text-gray-600 max-w-3xl mx-auto">我们是一群热爱《我的世界》的玩家，致力于收集和分享游戏中各种独特结构的坐标，让大家的游戏体验更加丰富多彩。</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-gray-50 rounded-xl p-6 shadow-md">
                    <div class="text-primary text-3xl mb-4">
                        <i class="fa fa-map-signs"></i>
                    </div>
                    <h3 class="text-xl font-bold text-dark mb-3">结构坐标库</h3>
                    <p class="text-gray-600">我们收集了各种稀有和独特的结构坐标，包括遗迹、自然奇观和特殊地点，让你无需探索即可轻松找到它们。</p>
                </div>
                
                <div class="bg-gray-50 rounded-xl p-6 shadow-md">
                    <div class="text-primary text-3xl mb-4">
                        <i class="fa fa-users"></i>
                    </div>
                    <h3 class="text-xl font-bold text-dark mb-3">社区共享</h3>
                    <p class="text-gray-600">Baka 村是一个开放的社区，所有玩家都可以贡献自己发现的坐标，与其他玩家分享游戏中的精彩发现。</p>
                </div>
                
                <div class="bg-gray-50 rounded-xl p-6 shadow-md">
                    <div class="text-primary text-3xl mb-4">
                        <i class="fa fa-gamepad"></i>
                    </div>
                    <h3 class="text-xl font-bold text-dark mb-3">游戏指南</h3>
                    <p class="text-gray-600">除了坐标库，我们还提供各种游戏攻略和指南，帮助你更好地探索《我的世界》的奇妙世界。</p>
                </div>
            </div>
            
            <div class="mt-12 text-center">
                <h3 class="text-2xl font-bold text-dark mb-6">加入我们</h3>
                <div class="flex flex-wrap justify-center gap-4">
                    <a href="#" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors shadow-lg shadow-primary/20 flex items-center">
                        <i class="fa fa-weixin mr-2"></i> 微信公众号
                    </a>
                    <a href="#" class="px-6 py-3 bg-white text-primary border border-primary rounded-lg hover:bg-primary/5 transition-colors flex items-center">
                        <i class="fa fa-qq mr-2"></i> QQ 群
                    </a>
                    <a href="#" class="px-6 py-3 bg-dark text-white rounded-lg hover:bg-dark/90 transition-colors flex items-center">
                        <i class="fa fa-github mr-2"></i> GitHub
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer class="bg-gray-900 text-gray-400 py-6">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <p>&copy; 2025 Baka 村结构坐标库. 保留所有权利.</p>
                </div>
                <div class="flex space-x-4">
                    <a href="#" class="hover:text-white transition-colors">隐私政策</a>
                    <a href="#" class="hover:text-white transition-colors">使用条款</a>
                    <a href="#" class="hover:text-white transition-colors">联系我们</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // 默认结构数据
        const defaultStructures = [
            {
                id: 1,
                name: "孤独堡垒",
                type: "遗迹",
                description: "试炼刷怪笼与那跃动的灵魂火，也许就是这堡垒里最后的活动之物了。如果感兴趣，你可以在那主塔楼的顶端见到巨大的旋风人。",
                image: 2,
                icon: "fa-fort-awesome",
                coordinates: {
                    server1: [
                        { id: 1, x: -1067, y: 128, z: 1099, description: "近" },
                        { id: 2, x: -543, y: 128, z: 3401, description: "近" },
                        { id: 3, x: 57, y: 128, z: 3629, description: "近" },
                        { id: 4, x: 2867, y: 128, z: 6279, description: "远" },
                        { id: 5, x: 719, y: 128, z: 6734, description: "远" },
                        { id: 6, x: -5163, y: 128, z: 5224, description: "远 "},
                        { id: 7, x: -1652, y: 128, z: -727, description: "近" },
                        { id: 8, x: -3721, y: 128, z: -959, description: "近" },
                        { id: 9, x: -6939, y: 128, z: -5902, description: "远" },
                        { id: 10, x: 429, y: 128, z: -1713, description: "近" },
                        { id: 11, x: 3619, y: 128, z: -2394, description: "近" },
                    ],
                    server2: [
                        { id: 1, x: 300, y: 75, z: -200, description: "哼" }
                    ]
                }
            },
            {
                id: 2,
                name: "丛林神殿",
                type: "遗迹",
                description: "隐藏在茂密丛林中的古老神殿，周围缠绕着藤蔓和树木。神殿内部布满陷阱，特别是在宝箱周围，需要小心触发。",
                image: 3,
                icon: "fa-tree",
                coordinates: {
                    server1: [
                        { id: 1, x: -37, y: 128, z: 535, description: "近" },
                        { id: 2, x: -1033, y: 128, z: -295, description: "近" },
                        { id: 3, x: -4033, y: 128, z: -3240, description: "远" },
                        { id: 4, x: -5642, y: 128, z: -4848, description: "远" },
                        { id: 5, x: -2750, y: 128, z: -7152, description: "远" },
                        { id: 6, x: 323, y: 128, z: -7137, description: "远" },
                        { id: 7, x: 3886, y: 128, z: -6200, description: "远" },
                        { id: 8, x: 3915, y: 128, z: -6070, description: "远" },
                        { id: 9, x: 3802, y: 128, z: -3248, description: "远" },
                        { id: 10, x: 7306, y: 128, z: -2752, description: "远" },
                        { id: 11, x: 7491, y: 128, z: -2723, description: "远" },

                    ],
                    server2: [
                        { id: 1, x: -600, y: 65, z: 400, description: "哦" }
                    ]
                }
            },
            {
                id: 3,
                name: "沙漠神殿",
                type: "遗迹",
                description: "隐藏在沙漠中的古老神殿，被沙子覆盖。内部困有许多亡灵，还设有一些陷阱。",
                image: 4,
                icon: "fa-sun-o",
                coordinates: {
                    server1: [
                        { id: 1, x: 1500, y: 63, z: -700, description: "嗷" }
                    ],
                    server2: [
                        { id: 1, x: 1200, y: 63, z: -400, description: "嗷" }
                    ]
                }
            },
            {
                id: 4,
                name: "旋风云",
                type: "自然奇观",
                description: "天空中旋转的巨大云团，风呼啸，刷怪笼中的旋风人被靠近的玩家唤醒......特殊战利品：无冷却风弹、脆风棒、“风爆弹射”附魔书、“动能缓冲”附魔书",
                image: 5,
                icon: "fa-tornado",
                coordinates: {
                    server1: [
                        { id: 1, x: -10316, y: 128, z: 381, description: "喵" },
                        { id: 2, x: -10407, y: 128, z: 367, description: "喵" },
                        { id: 3, x: -10874, y: 128, z: 1089, description: "喵" },
                        { id: 4, x: -11476, y: 128, z: 7079, description: "喵" },
                        { id: 5, x: -11601, y: 128, z: 10357, description: "小旋风云" },
                        { id: 6, x: -7181, y: 128, z: 11312, description: "喵" },
                        { id: 7, x: -7194, y: 128, z: 11443, description: "喵" },
                        { id: 8, x: -7068, y: 128, z: 11277, description: "喵" },
                        { id: 9, x: -6699, y: 128, z: 11434, description: "喵" },
                        { id: 10, x: -6800, y: 128, z: 10938, description: "喵" },
                        { id: 11, x: -6715, y: 128, z: 10960, description: "喵" },
                        { id: 12, x: -6095, y: 128, z: 11566, description: "喵" },
                        { id: 13, x: -3329, y: 128, z: 11693, description: "喵" },
                        { id: 14, x: -1786, y: 128, z: 11803, description: "喵" },
                        { id: 15, x: -1652, y: 128, z: 11903, description: "喵" },
                        { id: 16, x: 3268, y: 128, z: 11656, description: "喵" },
                        { id: 17, x: 3244, y: 128, z: 11526, description: "喵" },
                        { id: 18, x: 7240, y: 128, z: 12360, description: "喵" },
                        { id: 19, x: 7337, y: 128, z: 12337, description: "喵" },
                        { id: 20, x: 9001, y: 128, z: 12245, description: "喵" },
                        { id: 21, x: 10342, y: 128, z: 12119, description: "喵" },
                        { id: 22, x: 11559, y: 128, z: 12373, description: "小旋风云" },
                        { id: 23, x: 8528, y: 128, z: 8424, description: "喵" },
                    ],
                    server2: [
                        { id: 1, x: -100, y: 90, z: -800, description: "喵" }
                    ]
                }
            },
            {
                id: 5,
                name: "善魂云",
                type: "自然奇观",
                description: "刷新在雪原、积雪高山、冰刺之地和冰封山峰群系空中的快乐云朵，云上雪屋的地下室里貌似关押着一只永远不会长大的小可爱，去解放它让它自由地追逐天空吧！特殊战利品：颜色各异的挽具、失水恶魂、“悠魂”附魔书、“纯真守护”附魔书”附魔书、“动能缓冲”附魔书",
                image: 6,
                icon: "fa-tornado",
                coordinates: {
                    server1: [
                        { id: 1, x: -10502, y: 128, z: 784, description: "喵" },
                        { id: 2, x: -11208, y: 128, z: 1843, description: "小善魂云 战利品不刷新" },
                        { id: 3, x: -11430, y: 128, z: 4195, description: "喵" },
                        { id: 4, x: -11392, y: 128, z: 4247, description: "小善魂云 战利品不刷新" },
                        { id: 5, x: -11688, y: 128, z: 10169, description: "喵" },
                        { id: 6, x: -11137, y: 128, z: 11200, description: "喵" },
                        { id: 7, x: -8434, y: 128, z: 11097, description: "喵" },
                        { id: 8, x: -7012, y: 128, z: 11464, description: "喵" },
                        { id: 9, x: -6982, y: 128, z: 11336, description: "喵" },
                        { id: 10, x: -6854, y: 128, z: 11312, description: "喵" },
                        { id: 11, x: -6076, y: 128, z: 11611, description: "喵" },
                        { id: 12, x: -5972, y: 128, z: 11604, description: "喵" },
                        { id: 13, x: 2418, y: 128, z: 12325, description: "喵" },
                        { id: 14, x: 10291, y: 128, z: 12242, description: "小善魂云 战利品不刷新" },
                        { id: 15, x: 11477, y: 128, z: 12220, description: "喵" },
                        { id: 16, x: 10346, y: 128, z: 7527, description: "喵" },
                        { id: 17, x: 12371, y: 128, z: 7200, description: "小善魂云 战利品不刷新" },
                        ],
                    server2: [
                        { id: 1, x: -100, y: 90, z: -800, description: "喵" },
                    ]
                }
            },
            {
                id: 6,
                name: "嘎吱村",
                type: "自然奇观",
                description: "新在苍白森林的灾厄营地，炼金房、图书馆、教堂、靶场......特殊战利品：音乐唱片-《Infinite Spooky Amethyst》、嘎吱佳酿、附有快速填装IV的弩",
                image: 7,
                icon: "fa-tornado",
                coordinates: {
                    server1: [
                        { id: 1, x: -11239, y: 128, z: 447, description: "4靶场1女巫" },
                        { id: 2, x: -12184, y: 128, z: 8198, description: "2靶场0女巫" },
                        { id: 3, x: 8222, y: 128, z: 12052, description: "3靶场1女巫" },
                        { id: 4, x: 11632, y: 128, z: 12342, description: "2靶场1女巫" },

                    ],
                    server2: [
                        { id: 1, x: -100, y: 90, z: -800, description: "喵" }
                    ]
                }
            },

        ];

        // 从本地存储加载结构数据
        function loadStructures() {
            const savedStructures = localStorage.getItem('mcStructures');
            return savedStructures ? JSON.parse(savedStructures) : defaultStructures;
        }

        // 保存结构数据到本地存储
        function saveStructures(structures) {
            localStorage.setItem('mcStructures', JSON.stringify(structures));
        }

        // 添加新结构
        function addStructure(structure) {
            const structures = loadStructures();
            
            // 为新结构生成唯一ID
            const newId = structures.length > 0 ? Math.max(...structures.map(s => s.id)) + 1 : 1;
            
            // 创建新结构对象
            const newStructure = {
                id: newId,
                name: structure.name,
                type: structure.type,
                description: structure.description,
                image: parseInt(structure.image),
                icon: structure.icon,
                coordinates: {
                    server1: [],
                    server2: []
                }
            };
            
            // 添加到结构列表
            structures.push(newStructure);
            
            // 保存到本地存储
            saveStructures(structures);
            
            return newStructure;
        }

        // 渲染结构卡片
        function renderStructureCard(structure, server) {
            const serverClass = server === 'server1' ? 'server1' : 'server2';
            const coordinates = structure.coordinates[server] || [];
            
            return `
                <div class="bg-white rounded-xl shadow-md overflow-hidden card-hover" data-structure="${structure.id}" data-server="${server}">
                    <div class="relative">
                        <div class="structure-image w-full h-48" style="background-image: url('${structure.image}.png')"></div>
                        <div class="absolute top-4 right-4 bg-white/80 backdrop-blur-sm rounded-full px-3 py-1 text-sm font-medium">
                            <i class="fa fa-map-marker mr-1 text-${serverClass}"></i> ${coordinates.length}个坐标
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-xl font-bold text-dark">${structure.name}</h3>
                                <span class="inline-block px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm mt-2">${structure.type}</span>
                            </div>
                            <div class="text-${serverClass} text-2xl">
                                <i class="fa ${structure.icon}"></i>
                            </div>
                        </div>
                        
                        <div class="mb-6 text-gray-600">
                            <p>${structure.description}</p>
                        </div>
                        
                        <!-- 坐标列表 -->
                        <div id="${server}-${structure.id}-coordinates" class="space-y-3 mb-6">
                            ${coordinates.length > 0 ? coordinates.map(coord => `
                                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="font-medium">
                                            #${coord.id} ${coord.description}
                                        </div>
                                        <div class="text-xs text-gray-500">
                                            <i class="fa fa-user mr-1"></i> 匿名
                                        </div>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <div class="grid grid-cols-3 gap-2 text-sm">
                                            <div class="bg-gray-100 px-3 py-1 rounded flex items-center">
                                                <i class="fa fa-arrow-right text-gray-500 mr-2"></i>
                                                <span class="font-mono">X: ${coord.x}</span>
                                            </div>
                                            <div class="bg-gray-100 px-3 py-1 rounded flex items-center">
                                                <i class="fa fa-arrow-up text-gray-500 mr-2"></i>
                                                <span class="font-mono">Y: ${coord.y}</span>
                                            </div>
                                            <div class="bg-gray-100 px-3 py-1 rounded flex items-center">
                                                <i class="fa fa-arrow-left text-gray-500 mr-2"></i>
                                                <span class="font-mono">Z: ${coord.z}</span>
                                            </div>
                                        </div>
                                        <button class="text-red-500 hover:text-red-700 transition-colors delete-coordinate-btn" data-server="${server}" data-structure="${structure.id}" data-id="${coord.id}">
                                            <i class="fa fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            `).join('') : '<p class="text-center text-gray-500 py-4">暂无坐标数据</p>'}
                        </div>
                        
                        <!-- 添加坐标表单 - 默认隐藏 -->
                        <div id="${server}-${structure.id}-add-form" class="hidden bg-gray-50 p-4 rounded-lg border border-gray-200 mt-4">
                            <h4 class="font-medium mb-3">添加新坐标</h4>
                            <div class="grid grid-cols-3 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">X 坐标</label>
                                    <input type="number" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-${serverClass}/50 focus:border-${serverClass}" placeholder="X">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Y 坐标</label>
                                    <input type="number" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-${serverClass}/50 focus:border-${serverClass}" placeholder="Y">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Z 坐标</label>
                                    <input type="number" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-${serverClass}/50 focus:border-${serverClass}" placeholder="Z">
                                </div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">坐标描述</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-${serverClass}/50 focus:border-${serverClass}" placeholder="例如：宝箱位置、入口等">
                            </div>
                            <div class="flex justify-end gap-2">
                                <button class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition-colors cancel-add-coordinate-btn">取消</button>
                                <button class="px-4 py-2 bg-${serverClass} text-white rounded-md hover:bg-${serverClass}/90 transition-colors add-coordinate-btn" data-structure="${structure.id}" data-server="${server}">添加坐标</button>
                            </div>
                        </div>
                        
                        <!-- 操作按钮 -->
                        <div class="flex justify-between items-center">
                            <button class="px-4 py-2 border border-${serverClass} text-${serverClass} rounded-md hover:bg-${serverClass}/10 transition-colors flex items-center toggle-coordinates-btn" data-structure="${structure.id}" data-server="${server}">
                                <span>展开全部</span>
                                <i class="fa fa-chevron-down ml-2"></i>
                            </button>
                            <button class="px-4 py-2 bg-accent text-white rounded-md hover:bg-accent/90 transition-colors flex items-center show-add-form-btn" data-structure="${structure.id}" data-server="${server}">
                                <i class="fa fa-plus mr-2"></i> 添加坐标
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-4 flex justify-between items-center">
                        <span class="text-xs text-gray-500">
                            <i class="fa fa-clock-o mr-1"></i>
                            ${new Date().toLocaleDateString('zh-CN')}
                        </span>
                        <button class="text-red-500 hover:text-red-700 text-sm delete-structure-btn" data-id="${structure.id}">
                            <i class="fa fa-trash mr-1"></i> 删除结构
                        </button>
                    </div>
                </div>
            `;
        }

        // 渲染所有结构
        function renderAllStructures() {
            const structures = loadStructures();
            const server1Content = document.getElementById('server1Content');
            const server2Content = document.getElementById('server2Content');
            
            server1Content.innerHTML = '';
            server2Content.innerHTML = '';
            
            structures.forEach(structure => {
                server1Content.innerHTML += renderStructureCard(structure, 'server1');
                server2Content.innerHTML += renderStructureCard(structure, 'server2');
            });
            
            // 重新绑定事件
            bindEvents();
        }

        // 添加坐标
        function addCoordinate(server, structureId) {
            const form = document.getElementById(`${server}-${structureId}-add-form`);
            const inputs = form.querySelectorAll('input');
            const xInput = inputs[0];
            const yInput = inputs[1];
            const zInput = inputs[2];
            const descInput = inputs[3];
            
            // 验证输入
            if (!xInput.value || !yInput.value || !zInput.value) {
                showNotification('请填写完整的坐标信息', 'error');
                return;
            }
            
            const structures = loadStructures();
            const structure = structures.find(s => s.id === structureId);
            
            if (!structure) {
                showNotification('结构不存在', 'error');
                return;
            }
            
            // 创建新坐标
            const coordinates = structure.coordinates[server] || [];
            const newId = coordinates.length > 0 ? Math.max(...coordinates.map(c => c.id)) + 1 : 1;
            
            const newCoord = {
                id: newId,
                x: parseInt(xInput.value),
                y: parseInt(yInput.value),
                z: parseInt(zInput.value),
                description: descInput.value || '新坐标'
            };
            
            // 添加到坐标列表
            structure.coordinates[server].push(newCoord);
            
            // 保存结构数据
            saveStructures(structures);
            
            // 重新渲染结构
            renderAllStructures();
            
            // 重置表单
            form.reset();
            
            // 隐藏表单
            form.classList.add('hidden');
            
            // 显示成功消息
            showNotification('坐标添加成功！', 'success');
        }

        // 删除坐标
        function deleteCoordinate(server, structureId, coordId) {
            if (!confirm('确定要删除这个坐标吗？')) return;
            
            const structures = loadStructures();
            const structure = structures.find(s => s.id === structureId);
            
            if (!structure) {
                showNotification('结构不存在', 'error');
                return;
            }
            
            // 删除坐标
            structure.coordinates[server] = structure.coordinates[server].filter(coord => coord.id !== coordId);
            
            // 保存结构数据
            saveStructures(structures);
            
            // 重新渲染结构
            renderAllStructures();
            
            // 显示成功消息
            showNotification('坐标已删除！', 'success');
        }

        // 删除结构
        function deleteStructure(structureId) {
            if (!confirm('确定要删除这个结构吗？所有相关坐标也将被删除！')) return;
            
            const structures = loadStructures();
            const newStructures = structures.filter(s => s.id !== structureId);
            
            // 保存结构数据
            saveStructures(newStructures);
            
            // 重新渲染结构
            renderAllStructures();
            
            // 显示成功消息
            showNotification('结构已删除！', 'success');
        }

        // 显示通知
        function showNotification(message, type = 'info') {
            // 移除现有通知
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            // 创建通知元素
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-500 notification ${
                type === 'success' ? 'bg-green-500 text-white' : 
                type === 'error' ? 'bg-red-500 text-white' : 'bg-blue-500 text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fa ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-times-circle' : 'fa-info-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            // 添加到页面
            document.body.appendChild(notification);
            
            // 自动关闭
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            }, 3000);
        }

        // 绑定事件
        function bindEvents() {
            // 添加结构表单提交
            document.getElementById('addStructureForm').addEventListener('submit', (e) => {
                e.preventDefault();
                
                const name = document.getElementById('structureName').value;
                const type = document.getElementById('structureType').value;
                const description = document.getElementById('structureDescription').value;
                const image = document.getElementById('structureImage').value;
                const icon = document.getElementById('structureIcon').value;
                
                if (!name || !type || !description || !image || !icon) {
                    showNotification('请填写所有必填字段', 'error');
                    return;
                }
                
                if (image < 2 || image > 20) {
                    showNotification('图片编号必须在2-20之间', 'error');
                    return;
                }
                
                // 添加新结构
                addStructure({
                    name,
                    type,
                    description,
                    image,
                    icon
                });
                
                // 重置表单
                document.getElementById('addStructureForm').reset();
                
                // 重新渲染结构
                renderAllStructures();
                
                // 显示成功消息
                showNotification('结构添加成功！', 'success');
                
                // 滚动到结构列表
                document.getElementById('structures').scrollIntoView({ behavior: 'smooth' });
            });
            
            // 添加坐标按钮
            document.querySelectorAll('.show-add-form-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const server = e.target.dataset.server;
                    const structureId = e.target.dataset.structure;
                    
                    // 隐藏所有表单
                    document.querySelectorAll('[id$="-add-form"]').forEach(form => {
                        form.classList.add('hidden');
                    });
                    
                    // 显示当前表单
                    const form = document.getElementById(`${server}-${structureId}-add-form`);
                    form.classList.remove('hidden');
                    
                    // 滚动到表单位置
                    form.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                });
            });
            
            // 添加坐标提交
            document.querySelectorAll('.add-coordinate-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const server = e.target.dataset.server;
                    const structureId = parseInt(e.target.dataset.structure);
                    addCoordinate(server, structureId);
                });
            });
            
            // 取消添加坐标
            document.querySelectorAll('.cancel-add-coordinate-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const form = e.target.closest('[id$="-add-form"]');
                    form.classList.add('hidden');
                });
            });
            
            // 删除坐标
            document.querySelectorAll('.delete-coordinate-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const server = e.target.dataset.server;
                    const structureId = parseInt(e.target.dataset.structure);
                    const coordId = parseInt(e.target.dataset.id);
                    deleteCoordinate(server, structureId, coordId);
                });
            });
            
            // 删除结构
            document.querySelectorAll('.delete-structure-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const structureId = parseInt(e.target.dataset.id);
                    deleteStructure(structureId);
                });
            });
            
            // 切换坐标显示
            document.querySelectorAll('.toggle-coordinates-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const server = e.target.dataset.server;
                    const structureId = e.target.dataset.structure;
                    const container = document.getElementById(`${server}-${structureId}-coordinates`);
                    const isExpanded = container.getAttribute('data-expanded') === 'true';
                    
                    if (isExpanded) {
                        container.setAttribute('data-expanded', 'false');
                        container.classList.add('max-h-60', 'overflow-y-hidden');
                        e.target.innerHTML = '<span>展开全部</span><i class="fa fa-chevron-down ml-2"></i>';
                    } else {
                        container.setAttribute('data-expanded', 'true');
                        container.classList.remove('max-h-60', 'overflow-y-hidden');
                        e.target.innerHTML = '<span>收起</span><i class="fa fa-chevron-up ml-2"></i>';
                    }
                });
            });
            
            // 服务器切换
            document.getElementById('serverSelector').addEventListener('change', (e) => {
                const server = e.target.value;
                document.getElementById('server1Content').classList.toggle('hidden', server !== 'server1');
                document.getElementById('server2Content').classList.toggle('hidden', server !== 'server2');
            });
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 渲染所有结构
            renderAllStructures();
            
            // 移动端菜单切换
            document.getElementById('mobileMenuBtn').addEventListener('click', () => {
                document.getElementById('mobileMenu').classList.toggle('hidden');
            });
            
            // 平滑滚动
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                        
                        // 关闭移动菜单
                        document.getElementById('mobileMenu').classList.add('hidden');
                    }
                });
            });
            
            // 滚动时导航栏样式变化
            window.addEventListener('scroll', () => {
                const header = document.querySelector('header');
                if (window.scrollY > 50) {
                    header.classList.add('py-2', 'shadow-lg');
                    header.classList.remove('py-4', 'shadow-md');
                } else {
                    header.classList.add('py-4', 'shadow-md');
                    header.classList.remove('py-2', 'shadow-lg');
                }
            });
            
            // 搜索功能
            document.getElementById('searchInput').addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const structures = document.querySelectorAll('[data-structure]');
                
                structures.forEach(structure => {
                    const name = structure.querySelector('h3').textContent.toLowerCase();
                    const type = structure.querySelector('span').textContent.toLowerCase();
                    const description = structure.querySelector('p').textContent.toLowerCase();
                    
                    if (name.includes(searchTerm) || type.includes(searchTerm) || description.includes(searchTerm)) {
                        structure.classList.remove('hidden');
                    } else {
                        structure.classList.add('hidden');
                    }
                });
            });
        });
    </script>
</body>
</html>
